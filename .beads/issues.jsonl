{"id":"debian-repro-0yl","title":"No tests for consensus comparison logic","description":"## Problem\n\nThe consensus comparison logic in `scripts/compare-platforms.sh` has no test coverage. This is critical security logic that determines if platforms agree.\n\n## Evidence\n\n```bash\n$ ls tests/\nrun-tests.sh\n```\n\nNo tests for:\n- `compare-platforms.sh`\n- `collect-results.sh`\n- Edge cases: single platform, partial results, checksum format variations\n\n## Impact\n\n- Bugs in consensus logic could miss real disagreements (false negatives)\n- Or flag false positives causing alert fatigue\n- Refactoring could break consensus detection silently\n\n## What needs testing\n\n1. **Basic consensus**: Two platforms, same checksums ‚Üí pass\n2. **Disagreement detection**: Two platforms, different checksums ‚Üí fail\n3. **Single platform handling**: Should fail (currently does)\n4. **Missing results**: One platform has results, other doesn't\n5. **Malformed input**: Invalid JSON, missing fields\n6. **Evidence generation**: Verify witness files created on disagreement\n\n## Implementation\n\nAdd BATS tests in `tests/`:\n```bash\n# tests/compare-platforms.bats\n@test \"consensus passes when platforms agree\" {\n  # Setup mock results\n  # Run compare-platforms.sh\n  # Assert exit 0\n}\n\n@test \"consensus fails when platforms disagree\" {\n  # Setup divergent mock results\n  # Run compare-platforms.sh\n  # Assert exit 1\n}\n```\n\n## Files to create/modify\n\n- tests/compare-platforms.bats (new)\n- tests/collect-results.bats (new)","status":"closed","priority":2,"issue_type":"bug","owner":"shiloh@heurich.com","created_at":"2026-02-03T23:20:12.829934-05:00","created_by":"Shiloh Heurich","updated_at":"2026-02-03T23:57:42.870468-05:00","closed_at":"2026-02-03T23:57:42.870468-05:00","close_reason":"Closed","dependencies":[{"issue_id":"debian-repro-0yl","depends_on_id":"debian-repro-680","type":"relates-to","created_at":"2026-02-03T23:47:46.011699-05:00","created_by":"Shiloh Heurich"}]}
{"id":"debian-repro-1u0","title":"Add third verification platform (GitLab CI) for stronger consensus","description":"## Problem\n\nThe consensus mechanism currently relies on two platforms (GitHub Actions + GCP). Adding a third platform would:\n1. Make collusion attacks harder (need to compromise 3 platforms instead of 2)\n2. Provide redundancy if one platform is unavailable\n3. Add organizational diversity (Microsoft, Google, GitLab)\n\n## Current State\n\nTwo platforms provide consensus:\n- GitHub Actions (Microsoft infrastructure)\n- Google Cloud Build (Google infrastructure)\n\nBoth are major cloud providers, but diversifying to include GitLab adds:\n- Different geographic distribution\n- Different organizational control\n- Defense in depth\n\n## Implementation Approach\n\n### GitLab CI Configuration\n\nCreate `.gitlab-ci.yml`:\n```yaml\nstages:\n  - fetch\n  - build\n  - verify\n  - report\n\nvariables:\n  DEBUERREOTYPE_VERSION: 'e044a8f'  # Must match other platforms\n\nfetch-params:\n  stage: fetch\n  script:\n    - ./scripts/fetch-official.sh --arch $ARCH --output-dir official-$ARCH\n\nbuild-rootfs:\n  stage: build\n  # Mirror GitHub Actions build logic\n  script:\n    - ./scripts/build-wrapper.sh ...\n\nverify:\n  stage: verify\n  script:\n    - ./scripts/verify-checksum.sh ...\n\nreport:\n  stage: report\n  artifacts:\n    paths:\n      - results/\n```\n\n### Result Collection\n\nUpdate `scripts/collect-results.sh` to fetch from GitLab:\n- Add `--gitlab-project` option\n- Fetch from GitLab Pages or artifacts API\n\n### Consensus Validation\n\nUpdate `scripts/compare-platforms.sh` to handle 3-way comparison:\n- Currently: all platforms must agree\n- With 3 platforms: still require all to agree (not majority)\n\n## Effort Estimate\n\n- GitLab CI configuration: 4-8 hours\n- Result collection updates: 2-4 hours\n- Testing and validation: 4-8 hours\n- Documentation: 2 hours\n\nTotal: 1-2 days\n\n## Prerequisites\n\n- GitLab account/project (can mirror GitHub repo)\n- GitLab CI runners with Docker support\n- QEMU for cross-architecture builds\n\n## Files to create/modify\n\n- .gitlab-ci.yml (new)\n- scripts/collect-results.sh\n- docs/architecture.md (update diagrams)\n\n## Related\n\n- docs/roadmap.md lists 'GitLab CI Integration' as planned","status":"open","priority":3,"issue_type":"feature","owner":"shiloh@heurich.com","created_at":"2026-02-03T23:46:29.366515-05:00","created_by":"Shiloh Heurich","updated_at":"2026-02-03T23:46:29.366515-05:00","dependencies":[{"issue_id":"debian-repro-1u0","depends_on_id":"debian-repro-680","type":"relates-to","created_at":"2026-02-03T23:47:46.635541-05:00","created_by":"Shiloh Heurich"}]}
{"id":"debian-repro-2dn","title":"Security doc falsely claims artifacts repo tampering is detected","description":"## Problem\n\ndocs/security.md claims the system detects \"Artifacts repository changes\" but this is false. The `docker-debian-artifacts` repository is the single trust point - the system trusts it unconditionally and cannot detect tampering.\n\n## Evidence\n\ndocs/security.md states:\n```\n| **Artifacts repository changes** | Yes | Unauthorized checksum changes detected |\n```\n\nBut the code unconditionally trusts whatever it clones:\n```bash\n# scripts/fetch-official.sh - no validation\ngit clone --depth 1 --single-branch --branch \"$branch\" \\\n  https://github.com/debuerreotype/docker-debian-artifacts.git\n\nserial=$(cat serial)                    # Trusted without verification\nepoch=$(cat debuerreotype-epoch)        # Trusted without verification\ncp \"$suite/rootfs.tar.xz.sha256\" ...   # Trusted without verification\n```\n\nThis contradicts docs/architecture.md which correctly identifies this as a \"single trust point.\"\n\n## Impact\n\n- False security assurance to users\n- Incorrect threat model documentation\n- Potential compliance/audit issues if users rely on this claim\n\n## Why detection is impossible\n\nThe system uses the artifacts repo as ground truth for comparisons. If an attacker modifies the repo:\n1. Changes checksums to match backdoored images\n2. Updates epoch/serial to match malicious builds\n3. Our builds would then \"match\" the malicious reference\n\n## Fix\n\nUpdate docs/security.md to:\n1. Change the table entry to show this is NOT detected\n2. Add explanation in Trust Dependencies section\n\n```markdown\n# In the detection table:\n| **Artifacts repository changes** | No | Single trust point (see Trust Dependencies) |\n\n# Add to Trust Dependencies section:\n### Single Trust Point\n\nThe `docker-debian-artifacts` repository is our source of truth. We do not validate its integrity beyond cloning. A compromise of this repository would not be detected by our system. Multi-platform consensus and registry verification protect against downstream tampering but not upstream.\n```\n\n## Files to modify\n\n- docs/security.md","status":"closed","priority":1,"issue_type":"bug","owner":"shiloh@heurich.com","created_at":"2026-02-03T23:12:41.811116-05:00","created_by":"Shiloh Heurich","updated_at":"2026-02-03T23:54:53.208383-05:00","closed_at":"2026-02-03T23:54:53.208383-05:00","close_reason":"Closed","dependencies":[{"issue_id":"debian-repro-2dn","depends_on_id":"debian-repro-680","type":"relates-to","created_at":"2026-02-03T23:47:45.804647-05:00","created_by":"Shiloh Heurich"}]}
{"id":"debian-repro-680","title":"Create security architecture review epic to track all security improvements","description":"## Overview\n\nThis epic tracks all security improvements identified in the February 2026 security architecture review.\n\n## Related Issues\n\nAll issues below are tracked as part of this security review:\n\n### Critical (P0)\n- **debian-repro-6y8**: Debuerreotype version mismatch breaks consensus\n\n### High Priority (P1)\n- **debian-repro-umi**: No alerting mechanism for verification failures\n- **debian-repro-ohx**: Registry verification defaults to only 2/5 architectures\n- **debian-repro-m8n**: Scheduled builds default to only 2/5 architectures\n- **debian-repro-apu**: GCP builds not triggered from GitHub (blocked by 6y8)\n- **debian-repro-2dn**: Security doc falsely claims artifacts repo tampering is detected\n- **debian-repro-l9x**: Architecture doc is stale - claims Docker Hub gap exists\n\n### Medium Priority (P2)\n- **debian-repro-0yl**: No tests for consensus comparison logic\n- **debian-repro-ebc**: Scheduled builds default to only 2/5 suites\n- **debian-repro-p31**: Add validation of docker-debian-artifacts repository integrity\n- **debian-repro-eh3**: Detection latency too long - weekly builds allow up to 14-day attack window\n\n### Low Priority (P3)\n- **debian-repro-1u0**: Add third verification platform (GitLab CI)\n- **debian-repro-uz1**: TOCTOU vulnerability in fetch-official.sh\n\n## Summary of Findings\n\nThe review identified gaps between documented security claims and implementation reality.\n\n## Threat Scenarios Validated\n\n1. **Artifacts repo compromise**: Would NOT detect (single trust point)\n2. **Single-platform CI compromise**: Would detect IF consensus worked\n3. **Docker Hub tampering**: Would detect (registry verification)\n\n## Recommended Fix Sequence\n\n1. Fix Debuerreotype version mismatch (debian-repro-6y8) - unblocks consensus\n2. Add GCP trigger workflow (debian-repro-apu) - enables automated consensus\n3. Expand default coverage (debian-repro-m8n, debian-repro-ohx, debian-repro-ebc)\n4. Implement alerting (debian-repro-umi) - make detection actionable\n5. Update documentation (debian-repro-2dn, debian-repro-l9x)\n6. Add consensus tests (debian-repro-0yl)\n7. Add artifacts validation (debian-repro-p31)\n\n## Review Document\n\nFull analysis available in conversation history. Key files examined:\n- docs/security.md\n- docs/architecture.md\n- scripts/fetch-official.sh\n- scripts/compare-platforms.sh\n- scripts/verify-registry.sh\n- .github/workflows/*.yml\n- cloudbuild.yaml\n- verify-local.sh","status":"open","priority":1,"issue_type":"epic","owner":"shiloh@heurich.com","created_at":"2026-02-03T23:46:58.820734-05:00","created_by":"Shiloh Heurich","updated_at":"2026-02-03T23:48:08.976621-05:00","dependencies":[{"issue_id":"debian-repro-680","depends_on_id":"debian-repro-6y8","type":"relates-to","created_at":"2026-02-03T23:47:45.486034-05:00","created_by":"Shiloh Heurich"},{"issue_id":"debian-repro-680","depends_on_id":"debian-repro-umi","type":"relates-to","created_at":"2026-02-03T23:47:45.59047-05:00","created_by":"Shiloh Heurich"},{"issue_id":"debian-repro-680","depends_on_id":"debian-repro-ohx","type":"relates-to","created_at":"2026-02-03T23:47:45.689477-05:00","created_by":"Shiloh Heurich"},{"issue_id":"debian-repro-680","depends_on_id":"debian-repro-2dn","type":"relates-to","created_at":"2026-02-03T23:47:45.796263-05:00","created_by":"Shiloh Heurich"},{"issue_id":"debian-repro-680","depends_on_id":"debian-repro-l9x","type":"relates-to","created_at":"2026-02-03T23:47:45.901117-05:00","created_by":"Shiloh Heurich"},{"issue_id":"debian-repro-680","depends_on_id":"debian-repro-0yl","type":"relates-to","created_at":"2026-02-03T23:47:46.004386-05:00","created_by":"Shiloh Heurich"},{"issue_id":"debian-repro-680","depends_on_id":"debian-repro-ebc","type":"relates-to","created_at":"2026-02-03T23:47:46.10714-05:00","created_by":"Shiloh Heurich"},{"issue_id":"debian-repro-680","depends_on_id":"debian-repro-apu","type":"relates-to","created_at":"2026-02-03T23:47:46.208978-05:00","created_by":"Shiloh Heurich"},{"issue_id":"debian-repro-680","depends_on_id":"debian-repro-p31","type":"relates-to","created_at":"2026-02-03T23:47:46.310881-05:00","created_by":"Shiloh Heurich"},{"issue_id":"debian-repro-680","depends_on_id":"debian-repro-m8n","type":"relates-to","created_at":"2026-02-03T23:47:46.41747-05:00","created_by":"Shiloh Heurich"},{"issue_id":"debian-repro-680","depends_on_id":"debian-repro-eh3","type":"relates-to","created_at":"2026-02-03T23:47:46.522687-05:00","created_by":"Shiloh Heurich"},{"issue_id":"debian-repro-680","depends_on_id":"debian-repro-1u0","type":"relates-to","created_at":"2026-02-03T23:47:46.627338-05:00","created_by":"Shiloh Heurich"},{"issue_id":"debian-repro-680","depends_on_id":"debian-repro-uz1","type":"relates-to","created_at":"2026-02-03T23:47:46.732092-05:00","created_by":"Shiloh Heurich"}]}
{"id":"debian-repro-6y8","title":"Debuerreotype version mismatch breaks consensus","description":"## Problem\n\nGitHub Actions uses debuerreotype commit `e044a8f` (post-0.16 with distro-info-data fix), while GCP cloudbuild.yaml and verify-local.sh use tag `0.16`. This version divergence will cause consensus validation to fail or mask real issues.\n\n## Evidence\n\n- `.github/workflows/reproducible-debian-build.yml` line 35: `DEBUERREOTYPE_VERSION: 'e044a8f'`\n- `cloudbuild.yaml` line 17: `_DEBUERREOTYPE_VERSION: '0.16'`\n- `verify-local.sh` line 127: `DEBUERREOTYPE_VERSION=\"0.16\"`\n\n## Impact\n\nConsensus validation requires identical checksums across platforms. Different debuerreotype versions may produce different outputs, causing:\n1. False consensus failures (versions produce different valid outputs)\n2. Masked tampering (real issues hidden by expected differences)\n\n## Fix\n\nUpdate cloudbuild.yaml and verify-local.sh to use `e044a8f`:\n\n```yaml\n# cloudbuild.yaml\n_DEBUERREOTYPE_VERSION: 'e044a8f'\n```\n\n```bash\n# verify-local.sh\nDEBUERREOTYPE_VERSION=\"e044a8f\"\n```\n\nAlso update the checkout command in cloudbuild.yaml step 'setup-debuerreotype' since it uses `--branch` which works for tags but commit SHAs need different handling.\n\n## Files to modify\n\n- cloudbuild.yaml\n- verify-local.sh","status":"closed","priority":0,"issue_type":"bug","owner":"shiloh@heurich.com","created_at":"2026-02-03T23:12:16.074119-05:00","created_by":"Shiloh Heurich","updated_at":"2026-02-03T23:52:22.844937-05:00","closed_at":"2026-02-03T23:52:22.844937-05:00","close_reason":"Closed","dependencies":[{"issue_id":"debian-repro-6y8","depends_on_id":"debian-repro-680","type":"relates-to","created_at":"2026-02-03T23:47:45.493991-05:00","created_by":"Shiloh Heurich"}]}
{"id":"debian-repro-apu","title":"GCP builds not triggered from GitHub - consensus requires manual intervention","description":"## Problem\n\nThe consensus validation workflow collects results from GCP but nothing triggers GCP builds. Without GCP results, consensus validation fails by design (requires 2+ platforms). This means multi-platform consensus is not actually automated.\n\n## Evidence\n\n1. `cloudbuild.yaml` exists but no GitHub workflow triggers it\n2. `consensus-validator.yml` lines 85-89 try to collect GCP results:\n   ```yaml\n   if [ \"$GCP_CREDS_AVAILABLE\" = \"true\" ] \u0026\u0026 [ -n \"$GCP_PROJECT\" ]; then\n     COLLECT_CMD=\"$COLLECT_CMD --gcp-project $GCP_PROJECT\"\n   ```\n3. `consensus-validator.yml` line 97 fails if only one platform:\n   ```bash\n   if [[ \"$PLATFORMS\" != *\",\"* ]]; then\n     echo \"‚ö†Ô∏è Only one platform available - consensus validation requires 2+ platforms\"\n     exit 1\n   fi\n   ```\n\n4. No workflow uses `gcloud builds submit` to trigger GCP builds\n\n## Current state\n\n- GitHub Actions builds run weekly (Sunday 00:00 UTC)\n- Consensus validator runs weekly (Monday 06:00 UTC)\n- GCP builds require external trigger (Cloud Build triggers or manual `gcloud builds submit`)\n- If GCP builds don't run, consensus validation always fails\n\n## Impact\n\n- Multi-platform consensus is not automated end-to-end\n- The security benefit of independent platforms requires manual coordination\n- Users may think consensus is working when it's not\n\n## Options\n\n### Option A: Document the gap (minimal)\nAdd to docs/consensus-validation-guide.md:\n```markdown\n## Current Limitation: Manual GCP Triggers\n\nThe consensus workflow collects results from GCP but does not trigger GCP builds.\nGCP builds must be triggered externally via:\n- Cloud Build triggers (recommended)\n- Manual: `gcloud builds submit --config=cloudbuild.yaml`\n\nWithout GCP results, consensus validation fails by design (requires 2+ platforms).\n```\n\n### Option B: Add GCP trigger workflow (full automation)\nCreate `.github/workflows/trigger-gcp-build.yml` that:\n1. Runs after `reproducible-debian-build.yml` completes\n2. Uses `gcloud builds submit --config=cloudbuild.yaml`\n3. Waits for completion before consensus validator runs\n\n### Option C: Use Cloud Build triggers\nConfigure GCP Cloud Build triggers to run on:\n- Same schedule as GitHub Actions\n- Or webhook from GitHub workflow completion\n\n## Files to modify\n\nOption A: docs/consensus-validation-guide.md\nOption B: Create .github/workflows/trigger-gcp-build.yml\nOption C: GCP console configuration (external)","status":"closed","priority":1,"issue_type":"bug","owner":"shiloh@heurich.com","created_at":"2026-02-03T23:12:58.363866-05:00","created_by":"Shiloh Heurich","updated_at":"2026-02-04T11:34:14.359777-05:00","closed_at":"2026-02-04T11:34:14.359777-05:00","close_reason":"Added trigger-gcp-build.yml workflow that triggers GCP Cloud Build after GitHub Actions builds complete","dependencies":[{"issue_id":"debian-repro-apu","depends_on_id":"debian-repro-6y8","type":"blocks","created_at":"2026-02-03T23:13:14.444435-05:00","created_by":"Shiloh Heurich"},{"issue_id":"debian-repro-apu","depends_on_id":"debian-repro-680","type":"relates-to","created_at":"2026-02-03T23:47:46.216808-05:00","created_by":"Shiloh Heurich"}]}
{"id":"debian-repro-ebc","title":"Scheduled builds default to only 2/5 suites","description":"## Problem\n\nBoth GitHub Actions and GCP scheduled builds default to only 'bookworm trixie', missing bullseye, forky (testing), and unstable. This reduces verification coverage.\n\n## Evidence\n\n`.github/workflows/reproducible-debian-build.yml` line 7-9:\n```yaml\nsuites:\n  default: 'bookworm trixie'\n```\n\nREADME.md claims:\n```\n**Suites:**\n- forky (testing)\n- trixie (stable)\n- bookworm (oldstable)\n- bullseye (oldoldstable)\n- unstable (sid)\n```\n\n## Impact\n\n- Supply chain attacks on bullseye, forky, or unstable images not detected by automated builds\n- Users relying on oldoldstable or testing suites have no automated verification\n\n## Considerations\n\n- More suites = longer build times and higher CI costs\n- Some suites may be intentionally excluded (bullseye approaching EOL)\n- forky/unstable are less stable targets\n\n## Fix options\n\n1. **Expand default** to all suites (most thorough)\n2. **Document exclusions** in README if intentional\n3. **Add separate workflow** for extended verification\n\n## Files to modify\n\n- .github/workflows/reproducible-debian-build.yml\n- cloudbuild.yaml\n- README.md (if documenting intentional exclusions)","status":"open","priority":2,"issue_type":"bug","owner":"shiloh@heurich.com","created_at":"2026-02-03T23:19:48.80095-05:00","created_by":"Shiloh Heurich","updated_at":"2026-02-03T23:19:48.80095-05:00","dependencies":[{"issue_id":"debian-repro-ebc","depends_on_id":"debian-repro-680","type":"relates-to","created_at":"2026-02-03T23:47:46.114943-05:00","created_by":"Shiloh Heurich"}]}
{"id":"debian-repro-eh3","title":"Detection latency too long - weekly builds allow up to 14-day attack window","description":"## Problem\n\nThe system's detection latency is up to 14 days:\n- Builds run weekly (Sundays 00:00 UTC)\n- Consensus validation runs weekly (Mondays 06:00 UTC)\n- An attacker could compromise images immediately after a build and remain undetected for nearly two weeks\n\n## Evidence\n\nFrom `.github/workflows/reproducible-debian-build.yml`:\n```yaml\nschedule:\n  # Run weekly to verify reproducibility\n  - cron: '0 0 * * 0'  # Sunday 00:00 UTC\n```\n\nFrom `.github/workflows/consensus-validator.yml`:\n```yaml\nschedule:\n  # Run weekly at 6 AM UTC on Mondays\n  - cron: '0 6 * * 1'\n```\n\nRegistry verification is daily, but reproducibility verification is weekly.\n\n## Impact\n\n- Worst case: 13+ days between attack and detection\n- Supply chain attacks could affect many downstream users before detection\n- Contrast with registry verification which is daily\n\n## Options\n\n### Option A: Increase frequency to daily\nPros: Much faster detection\nCons: Higher CI costs, more runner time\n\n### Option B: Add lightweight daily check\nRun full builds weekly but add daily smoke test of one suite/arch combination.\n\n### Option C: Event-driven verification\nTrigger verification when Debian publishes new artifacts (monitor docker-debian-artifacts for commits).\n\n## Recommendation\n\nOption C provides best balance - verify whenever official builds change, don't waste resources when nothing changed.\n\n## Files to modify\n\n- .github/workflows/reproducible-debian-build.yml (schedule)\n- Potentially new workflow for artifact monitoring\n\n## Related\n\n- docs/roadmap.md mentions 'Daily Builds' as planned feature","status":"open","priority":2,"issue_type":"bug","owner":"shiloh@heurich.com","created_at":"2026-02-03T23:46:13.563171-05:00","created_by":"Shiloh Heurich","updated_at":"2026-02-03T23:46:13.563171-05:00","dependencies":[{"issue_id":"debian-repro-eh3","depends_on_id":"debian-repro-680","type":"relates-to","created_at":"2026-02-03T23:47:46.530897-05:00","created_by":"Shiloh Heurich"}]}
{"id":"debian-repro-l9x","title":"Architecture doc is stale - claims Docker Hub gap exists but registry verification is implemented","description":"## Problem\n\ndocs/architecture.md still describes Docker Hub verification as a gap and planned feature, but it's already implemented. This creates confusion about the system's actual capabilities.\n\n## Evidence\n\ndocs/architecture.md contains:\n```\n‚îÇ Docker Hub ‚îÇ\n‚îÇ (gap)      ‚îÇ\n...\n**Gap**: We don't verify Docker Hub images match the artifacts repository.\n**Planned**: Direct Docker Hub verification closes this gap.\n```\n\nBut registry verification is fully implemented:\n- `.github/workflows/registry-verification.yml` - daily automated workflow\n- `scripts/verify-registry.sh` - compares diff_ids between Docker Hub and artifacts\n- `docs/registry-verification.md` - complete documentation\n\n## Impact\n\n- New contributors get incorrect understanding of system capabilities\n- Security assessors may incorrectly report Docker Hub as unverified\n- Documentation doesn't reflect actual security posture\n\n## Fix\n\nUpdate docs/architecture.md to:\n1. Remove the \"(gap)\" label from Docker Hub in the diagram\n2. Replace the Gap/Planned section with description of implemented registry verification\n3. Add reference to docs/registry-verification.md\n4. Update the trust diagram to show the verification link\n\nSuggested replacement for the trust section:\n```markdown\n## Trust Model\n\nThe `docker-debian-artifacts` repository is our single trust point. Registry verification (see [Registry Verification](registry-verification.md)) closes the gap between the artifacts repository and Docker Hub by comparing diff_ids daily.\n```\n\n## Files to modify\n\n- docs/architecture.md","status":"closed","priority":1,"issue_type":"bug","owner":"shiloh@heurich.com","created_at":"2026-02-03T23:12:28.088896-05:00","created_by":"Shiloh Heurich","updated_at":"2026-02-03T23:53:31.917998-05:00","closed_at":"2026-02-03T23:53:31.917998-05:00","close_reason":"Closed","dependencies":[{"issue_id":"debian-repro-l9x","depends_on_id":"debian-repro-680","type":"relates-to","created_at":"2026-02-03T23:47:45.909222-05:00","created_by":"Shiloh Heurich"}]}
{"id":"debian-repro-m8n","title":"Scheduled builds default to only 2/5 architectures","description":"## Problem\n\nGitHub Actions scheduled builds default to only 'amd64,arm64', missing armhf, i386, and ppc64el. This leaves 60% of supported architectures unverified for reproducibility.\n\n## Evidence\n\n`.github/workflows/reproducible-debian-build.yml` line 17-19:\n```yaml\narchitectures:\n  default: 'amd64,arm64,armhf,i386,ppc64el'  # Manual trigger supports all\n```\n\nBut the scheduled runs in `latest.json` show only 2 architectures verified.\n\nThe dashboard (`dashboard/data/latest.json`) shows:\n```json\n\"architectures\": {\n  \"arm64\": { ... },\n  \"amd64\": { ... }\n}\n```\n\nREADME.md claims coverage for all 5 architectures.\n\n## Impact\n\n- Supply chain attacks on armhf, i386, or ppc64el images would go undetected by automated weekly builds\n- Only manual triggers verify all architectures\n- Users relying on these architectures have reduced protection\n\n## Related\n\nThis is similar to debian-repro-ohx (registry verification coverage) but for the main build workflow.\n\n## Fix\n\nEnsure scheduled builds include all 5 architectures:\n```yaml\n# In schedule block, override defaults:\narchitectures:\n  default: 'amd64,arm64,armhf,i386,ppc64el'\n```\n\nOr verify that the scheduled trigger properly uses all architectures (may need to check why only 2 appear in results).\n\n## Files to modify\n\n- .github/workflows/reproducible-debian-build.yml","status":"closed","priority":1,"issue_type":"bug","owner":"shiloh@heurich.com","created_at":"2026-02-03T23:46:00.296701-05:00","created_by":"Shiloh Heurich","updated_at":"2026-02-04T11:34:14.469071-05:00","closed_at":"2026-02-04T11:34:14.469071-05:00","close_reason":"Changed scheduled build defaults from amd64,arm64 to all 5 architectures in both build and registry workflows","dependencies":[{"issue_id":"debian-repro-m8n","depends_on_id":"debian-repro-680","type":"relates-to","created_at":"2026-02-03T23:47:46.425346-05:00","created_by":"Shiloh Heurich"}]}
{"id":"debian-repro-ohx","title":"Registry verification defaults to only 2/5 architectures","description":"## Problem\n\nRegistry verification workflow defaults to only amd64 and arm64, missing armhf, i386, and ppc64el. This leaves 60% of supported architectures unverified for Docker Hub tampering.\n\n## Evidence\n\n`.github/workflows/registry-verification.yml` line 12-13:\n```yaml\narchitectures:\n  default: 'amd64,arm64'\n```\n\nBut README.md claims coverage for all 5 architectures:\n```\n**Architectures:**\n- Supported: amd64, arm64, armhf, i386, ppc64el\n```\n\n## Impact\n\nDocker Hub tampering on armhf, i386, or ppc64el images would go undetected by daily automated verification.\n\n## Fix\n\nChange default to include all architectures:\n```yaml\ndefault: 'amd64,arm64,armhf,i386,ppc64el'\n```\n\n## Files to modify\n\n- .github/workflows/registry-verification.yml","status":"closed","priority":1,"issue_type":"bug","owner":"shiloh@heurich.com","created_at":"2026-02-03T23:19:39.605866-05:00","created_by":"Shiloh Heurich","updated_at":"2026-02-03T23:56:11.313847-05:00","closed_at":"2026-02-03T23:56:11.313847-05:00","close_reason":"Closed","dependencies":[{"issue_id":"debian-repro-ohx","depends_on_id":"debian-repro-680","type":"relates-to","created_at":"2026-02-03T23:47:45.697168-05:00","created_by":"Shiloh Heurich"}]}
{"id":"debian-repro-p31","title":"Add validation of docker-debian-artifacts repository integrity","description":"## Problem\n\nThe `docker-debian-artifacts` repository is a single trust point with no integrity validation. A compromise of this repository would not be detected.\n\n## Current state\n\n`scripts/fetch-official.sh` clones the repository and trusts all contents unconditionally:\n- No GPG signature verification\n- No comparison against historical values\n- No multi-source validation\n\n## Potential mitigations\n\n### 1. Historical comparison (detect sudden changes)\nStore previous serial/epoch values and alert on unexpected jumps:\n```bash\n# Compare new serial against last known\nif [ \"$new_serial\" != \"$last_serial\" ]; then\n  # Validate jump is reasonable (not too far in past/future)\n  # Alert if unexpected\nfi\n```\n\n### 2. Multi-source validation\nCross-reference against other Debian sources:\n- Check snapshot.debian.org exists for claimed serial\n- Verify epoch is within expected range\n- Compare against Docker Hub image creation timestamps\n\n### 3. GPG verification (if available)\nIf Debian signs the artifacts repo or individual files, verify signatures.\n\n### 4. Commit signing verification\nVerify commits to docker-debian-artifacts are signed by known Debian keys.\n\n## Scope\n\nThis is an enhancement to reduce trust surface. Complete elimination of this trust point is not possible since we need a reference to compare against.\n\n## Files to potentially modify\n\n- scripts/fetch-official.sh (add validation)\n- scripts/common.sh (add validation functions)\n- New: scripts/validate-artifacts-repo.sh\n\n## Related\n\nThis is explicitly documented as out-of-scope in docs/security.md but could be a roadmap item.","status":"open","priority":2,"issue_type":"feature","owner":"shiloh@heurich.com","created_at":"2026-02-03T23:13:10.257408-05:00","created_by":"Shiloh Heurich","updated_at":"2026-02-03T23:45:46.187345-05:00","dependencies":[{"issue_id":"debian-repro-p31","depends_on_id":"debian-repro-680","type":"relates-to","created_at":"2026-02-03T23:47:46.31893-05:00","created_by":"Shiloh Heurich"}]}
{"id":"debian-repro-umi","title":"No alerting mechanism for verification failures","description":"## Problem\n\nWhen verification fails (reproducibility mismatch, consensus failure, or registry tampering), there's no notification mechanism. The dashboard updates silently. This defeats the purpose of detecting supply chain attacks if no one is alerted.\n\n## Evidence\n\nSearched all workflows - no notification steps found:\n- No Slack/Discord/email integrations\n- No GitHub issue creation on failure\n- No webhook triggers\n\nWorkflows only update dashboard and exit with failure code:\n```bash\n# From verify-checksum.sh\nexit 1  # Silent failure, no notification\n```\n\n## Impact\n\n- **Critical**: Supply chain attack detection is useless if no one sees the alert\n- Human must manually check dashboard or CI status\n- Weekend/holiday attacks could go unnoticed for days\n\n## Proposed solutions\n\n1. **GitHub Actions native**: Create issue or discussion on failure\n2. **Webhook**: POST to monitoring endpoint\n3. **Email**: Use `dawidd6/action-send-mail` action\n4. **Slack/Discord**: Post to security channel\n\n## Implementation sketch\n\nAdd to `reproducible-debian-build.yml`:\n```yaml\nalert-on-failure:\n  needs: [build]\n  if: failure()\n  runs-on: ubuntu-24.04\n  steps:\n    - uses: actions/github-script@v7\n      with:\n        script: |\n          github.rest.issues.create({\n            owner: context.repo.owner,\n            repo: context.repo.repo,\n            title: 'üö® Reproducibility verification failed',\n            body: 'Build ${{ github.run_id }} detected non-reproducible images...',\n            labels: ['security', 'alert']\n          })\n```\n\n## Files to modify\n\n- .github/workflows/reproducible-debian-build.yml\n- .github/workflows/registry-verification.yml\n- .github/workflows/consensus-validator.yml","status":"closed","priority":1,"issue_type":"bug","owner":"shiloh@heurich.com","created_at":"2026-02-03T23:20:02.908959-05:00","created_by":"Shiloh Heurich","updated_at":"2026-02-04T11:34:14.415597-05:00","closed_at":"2026-02-04T11:34:14.415597-05:00","close_reason":"Added alert-on-failure jobs to reproducible-debian-build.yml and registry-verification.yml that create GitHub Issues on failures","dependencies":[{"issue_id":"debian-repro-umi","depends_on_id":"debian-repro-680","type":"relates-to","created_at":"2026-02-03T23:47:45.598469-05:00","created_by":"Shiloh Heurich"}]}
{"id":"debian-repro-uz1","title":"TOCTOU vulnerability in fetch-official.sh - parameters could change between fetch and use","description":"## Problem\n\nTime-of-check-time-of-use (TOCTOU) vulnerability exists in the parameter fetching flow. Between cloning docker-debian-artifacts and using the parameters, the upstream repository could be modified.\n\n## Attack Scenario\n\n1. Agent clones docker-debian-artifacts at time T1\n2. Attacker pushes malicious commit at time T2\n3. Another agent (or Docker Hub) uses parameters from the now-modified repo\n4. Verification passes because parameters and images now 'match'\n\nThis is a narrow window but could be exploited in a targeted attack.\n\n## Evidence\n\n`scripts/fetch-official.sh` clones at one point:\n```bash\ngit clone --depth 1 --single-branch --branch \"$branch\" \\\n  https://github.com/debuerreotype/docker-debian-artifacts.git \\\n  \"$temp_dir\"\n```\n\nParameters are then used throughout the build. No commit SHA is recorded to ensure other platforms use the same version.\n\n## Current Mitigations\n\n- Multi-platform consensus: attackers would need to time attack perfectly for all platforms\n- Weekly builds: attack window is predictable, limiting opportunity\n\n## Proposed Fix\n\nPin to specific commit SHA after initial clone:\n```bash\n# After clone, record the exact commit\nARTIFACTS_COMMIT=$(git -C \"$temp_dir\" rev-parse HEAD)\necho \"$ARTIFACTS_COMMIT\" \u003e \"$output_dir/artifacts-commit.txt\"\n\n# Report in logs for consensus comparison\nlog_info \"Using artifacts commit: $ARTIFACTS_COMMIT\"\n```\n\nThen validate in consensus that all platforms used the same commit:\n```bash\n# In compare-platforms.sh\n# Extract and compare artifacts_commit from each platform's report\n```\n\n## Impact\n\nLow likelihood (requires precise timing and upstream access) but high impact if exploited.\n\n## Files to modify\n\n- scripts/fetch-official.sh (record commit SHA)\n- scripts/generate-report.sh (include commit in report)\n- scripts/compare-platforms.sh (validate commit matches)\n- .github/workflows/reproducible-debian-build.yml (log commit SHA)\n- cloudbuild.yaml (log commit SHA)","status":"open","priority":3,"issue_type":"bug","owner":"shiloh@heurich.com","created_at":"2026-02-03T23:46:43.874541-05:00","created_by":"Shiloh Heurich","updated_at":"2026-02-03T23:46:43.874541-05:00","dependencies":[{"issue_id":"debian-repro-uz1","depends_on_id":"debian-repro-680","type":"relates-to","created_at":"2026-02-03T23:47:46.739223-05:00","created_by":"Shiloh Heurich"}]}
